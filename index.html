<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>New Leaf Painting Co. | Interior Painting in Southern Maine</title>
  <meta name="description" content="New Leaf Painting Co. provides expert interior painting for high-end homes in Cumberland, Falmouth, Cape Elizabeth, Yarmouth, Kennebunkport, and throughout Southern Maine. Services include walls, trim, baseboards, cabinets, and doors. Reliable, professional results for every home.">
  <link rel="stylesheet" href="style.css" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZFESYBBBWD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZFESYBBBWD');
  </script>

  <style>
    /* ===== Gate Overlay (shows on direct entry ONLY) ===== */
    #nl-gate {
      position: fixed;
      inset: 0;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;

      /* ✅ CHANGED: black background */
      background: #000;
      overflow: hidden; /* keeps fireworks clean */
    }

    #nl-gate .gate-inner {
      text-align: center;
      max-width: 760px;
      width: 100%;
      padding: 28px 18px;
      position: relative;
      z-index: 2; /* above fireworks */
    }

    /* ✅ NEW: fireworks canvas */
    #nl-fireworks {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
      opacity: 1;
    }

    /* ✅ NEW: fireworks fade-out */
    #nl-fireworks.fade-out {
      opacity: 0;
      transition: opacity 1200ms ease;
    }

    #nl-gate .gate-logo {
  width: min(300px, 75vw); /* slightly smaller, more premium */
  height: auto;
  margin: 0 auto 18px auto;
  display: block;

  /* remove white haze */
  background: transparent;
  border-radius: 0;
  padding: 0;

  /* subtle glow so it pops on black */
  filter: drop-shadow(0 0 22px rgba(80, 255, 160, 0.45));
}

    #nl-gate .gate-line {
      margin: 0 auto 18px auto;
      font-size: 1.05rem;
      color: rgba(255,255,255,.92);
    }

    .gate-btn-row{
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top: 10px;
    }

    #nl-gate .gate-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 14px 18px;
      border-radius: 12px;
      border: 2px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.92);
      color: #0f5f33;
      font-weight: 900;
      letter-spacing: .2px;
      cursor: pointer;
      transition: transform .15s ease, filter .15s ease;
      min-width: 230px;
    }
    #nl-gate .gate-btn:hover { transform: translateY(-1px); filter: brightness(1.02); }
    #nl-gate .gate-btn:active { transform: translateY(0px); filter: brightness(.98); }

    #nl-gate .gate-btn.alt {
      background: rgba(0,0,0,.18);
      color: #fff;
      border-color: rgba(255,255,255,.18);
      font-weight: 800;
    }

    /* ✅ NEW: glowing heartbeat for ENTER button only */
    #nl-enter {
      animation: nlPulseGlow 2.1s ease-in-out infinite;
      box-shadow:
        0 0 0 rgba(0,0,0,0),
        0 0 18px rgba(0,0,0,0);
    }

    @keyframes nlPulseGlow {
      0% {
        box-shadow:
          0 0 0 0 rgba(0,0,0,0),
          0 0 10px rgba(15,95,51,.55);
        filter: brightness(1.00);
      }
      50% {
        box-shadow:
          0 0 0 6px rgba(79, 255, 146, .18),
          0 0 34px rgba(79, 255, 146, .85);
        filter: brightness(1.08);
      }
      100% {
        box-shadow:
          0 0 0 0 rgba(0,0,0,0),
          0 0 10px rgba(15,95,51,.55);
        filter: brightness(1.00);
      }
    }

    #nl-gate.fade-out {
      opacity: 0;
      pointer-events: none;
      transition: opacity 1200ms ease;
    }

    /* ===== Modes ===== */
    #nl-hub, #nl-standard { display: none; }

    /* In HUB mode, hide anything global if it exists */
    body.mode-hub #global-header,
    body.mode-hub #global-footer,
    body.mode-hub #contact-btn,
    body.mode-hub #contact-popup { display: none !important; }

    /* ===== HUB layout ===== */
    #nl-hub {
      min-height: 100vh;
      background: #0f5f33;
      display: grid;
      place-items: center;
      padding: 26px 14px;
    }
    .nl-hub-inner{
      width: 100%;
      max-width: 720px;
      text-align: center;
    }

    .nl-hub-logo{
      width: 160px;
      max-width: 160px;
      height: auto;
      display: block;
      margin: 0 auto 10px auto;
      background: rgba(255,255,255,.06);
      border-radius: 16px;
      padding: 10px;
    }

    /* NEW: clarity line under logo */
    .nl-hub-line{
      margin: 0 auto 18px auto;
      max-width: 620px;
      font-size: 1.02rem;
      color: rgba(255,255,255,.92);
      line-height: 1.35;
    }

    .nl-hub-grid{
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      width: 100%;
      max-width: 560px;
      margin: 0 auto;
      padding: 0 12px;
      box-sizing: border-box;
    }

    #nl-hub .nl-btn{
      border-radius: 12px;
      padding: 12px 14px;
      font-weight: 800;
      font-size: 0.95rem;
      border: 2px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      color: #fff;
      cursor: pointer;
      text-decoration: none;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: transform .12s ease, filter .12s ease, background .12s ease;
      width: 100%;
      text-align: center;
      box-sizing: border-box;
      overflow: hidden;
    }

    #nl-hub .nl-btn:hover { transform: translateY(-1px); filter: brightness(1.05); }

    #nl-hub .nl-btn.primary{
      background: rgba(255,255,255,.92);
      color: #0f5f33;
      border-color: rgba(255,255,255,.22);
    }

    #nl-hub .nl-btn.spin{
      background: rgba(31,107,51,.95);
      color: #fff;
      border-color: rgba(255,255,255,.18);
    }

    #nl-hub .nl-btn.primary,
    #nl-hub .nl-btn.full {
      grid-column: 1 / -1;
    }

    @media (max-width: 360px) {
      .nl-hub-grid { grid-template-columns: 1fr; }
    }

    /* NEW: small “upgrade” link styling (boring mode) */
    .nl-upgrade-link{
      display:inline-block;
      margin: 10px 0 0 0;
      font-weight: 800;
      text-decoration: underline;
      cursor: pointer;
    }
  </style>
</head>

<body>

  <!-- ===== Gate Overlay ===== -->
  <div id="nl-gate" aria-label="New Leaf Gate" role="dialog" aria-modal="true">
    <!-- ✅ NEW: fireworks canvas layer -->
    <canvas id="nl-fireworks" aria-hidden="true"></canvas>

    <div class="gate-inner">
      <img class="gate-logo" src="E25C1BF6-8B68-40AD-BC11-2427F37BC179.png" alt="New Leaf Painting Co.">
      <p class="gate-line">Not your typical painter website.</p>

      <div class="gate-btn-row">
        <button id="nl-enter" class="gate-btn" type="button">
          Enter the New Leaf Experience <span aria-hidden="true">→</span>
        </button>

        <button id="nl-skip" class="gate-btn alt" type="button">
          Skip (I hate fun)
        </button>
      </div>
    </div>
  </div>

  <!-- ===== HUB MODE (Experience) ===== -->
  <main id="nl-hub" aria-label="New Leaf Experience Hub">
    <div class="nl-hub-inner">
      <img class="nl-hub-logo" src="7D16A71A-2AF9-4EBB-863A-09C24D4F6662.png" alt="New Leaf Painting Co.">

      <p class="nl-hub-line">
        You’re already here. Proven work, real reviews — and rewards you won’t find on any other painter’s site.
      </p>

      <div class="nl-hub-grid">
        <a class="nl-btn" href="#games">Play for Rewards</a>
        <a class="nl-btn spin" href="#spinwin">Spin &amp; Win (Everyone Wins) ✨</a>

        <a class="nl-btn" href="past-projects.html">See Transformations</a>
        <a class="nl-btn" href="referus.html">Refer New Leaf Painting Co.</a>

        <button
          type="button"
          class="nl-btn primary"
          onclick="document.getElementById('contact-popup')?.style && (document.getElementById('contact-popup').style.display='flex');">
          Schedule a Free Estimate
        </button>

        <a class="nl-btn" href="local-partners.html">Local Partners</a>
        <a class="nl-btn" href="testimonials.html">Read Reviews</a>
      </div>
    </div>
  </main>

  <!-- ===== STANDARD MODE (Normal site) ===== -->
  <div id="nl-standard">
    <div id="global-header"></div>

    <section class="hero">
      <h1>Turn over a New Leaf — With a fresh new coat, one room at a time.</h1>
      <p>Professional interior painting built on trust, quality, and care.</p>

      <p>
        <a class="nl-upgrade-link" id="nl-upgrade" href="index.html?nav=1&mode=hub">
          I want the full experience →
        </a>
      </p>

      <section class="about">
        <h2>Why Choose New Leaf Painting Co.</h2>
        <p>New Leaf Painting Co. isn’t just another painting service — we’re dedicated to giving your home the attention and renewal it deserves. Every brush stroke matters because your space deserves more than a quick coat; it deserves craftsmanship, precision, and pride.</p>

        <ul>
          <li><strong>Professional quality</strong> at fair, transparent prices</li>
          <li><strong>Respect for your home</strong> — we show up on time, protect your space, and clean up fully</li>
          <li><strong>Attention to detail</strong> that transforms a room, not just paints it</li>
          <li><strong>A smooth process</strong> from estimate to final walkthrough</li>
        </ul>
      </section>

      <button
        type="button"
        class="cta-button"
        onclick="document.getElementById('contact-popup').style.display='flex';">
        Schedule a Free Estimate
      </button>
    </section>

    <section class="services">
      <h2>Our Services</h2>
      <ul>
        <li>Interior Painting</li>
        <li>Cabinet Painting & Refinishing</li>
        <li>Drywall Repair and Surface Prep</li>
        <li>Drop Ceiling installation</li>
        <li>Light Carpentry</li>
        <li>Accent walls & color matching</li>
        <li>Eco-friendly paint options</li>
      </ul>
    </section>

    <section class="testimonial">
      <blockquote>
        “I am absolutely thrilled with the results of my kitchen cabinets. They completely transformed my kitchen and the finish looks perfect. I highly recommend!!”
      </blockquote>
      <p>— John M., Old Orchard Beach, ME</p>
    </section>

    <div id="global-footer"></div>
  </div>

  <script>
    (function initNewLeafGateModes(){
      const gate = document.getElementById("nl-gate");
      const enterBtn = document.getElementById("nl-enter");
      const skipBtn  = document.getElementById("nl-skip");

      const hub = document.getElementById("nl-hub");
      const standard = document.getElementById("nl-standard");

      // URL flags:
      // - nav=1 means internal navigation (NO gate)
      // - mode=hub or mode=standard controls which view to show
      const params = new URLSearchParams(window.location.search);
      const nav = params.get("nav"); // "1" when navigating internally
      const modeParam = (params.get("mode") || "").toLowerCase(); // "hub" or "standard"

      // Always start hidden; we'll show exactly what we want
      hub.style.display = "none";
      standard.style.display = "none";

      function buildModeQuery(mode){
        return `?nav=1&mode=${encodeURIComponent(mode)}`;
      }

      function isExternalHref(href){
        return (
          href.startsWith("http://") ||
          href.startsWith("https://") ||
          href.startsWith("mailto:") ||
          href.startsWith("tel:")
        );
      }

      // Ensure internal links carry nav=1&mode=...
      function decorateLinks(mode){
        document.querySelectorAll('a[href]').forEach(a => {
          const href = a.getAttribute("href");
          if (!href) return;
          if (href.startsWith("#")) return;
          if (isExternalHref(href)) return;
          if (href.startsWith("javascript:")) return;
          if (href.includes("nav=1")) return;

          const joiner = href.includes("?") ? "&" : "?";
          a.setAttribute("href", href + joiner + `nav=1&mode=${encodeURIComponent(mode)}`);
        });
      }

      function closeGate(){
        if (!gate) return;
        gate.classList.add("fade-out");
        setTimeout(() => gate.remove(), 1250);
      }

      async function loadGlobalForStandard(mode){
        const res = await fetch("global.html");
        const html = await res.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, "text/html");

        const header = doc.querySelector("header");
        const footer = doc.querySelector("footer");
        const popup  = doc.querySelector("#contact-popup");
        const btn    = doc.querySelector("#contact-btn");

        const headerTarget = document.getElementById("global-header");
        const footerTarget = document.getElementById("global-footer");

        if (headerTarget && header) headerTarget.replaceChildren(header);
        if (footerTarget && footer) footerTarget.replaceChildren(footer);

        if (popup && !document.querySelector("#contact-popup")) {
          document.body.insertAdjacentElement("beforeend", popup);
        }
        if (btn && !document.querySelector("#contact-btn")) {
          document.body.insertAdjacentElement("beforeend", btn);
        }

        const funRow = document.getElementById("nl-experience-nav");
        if (funRow) funRow.style.display = "none";

        const popupEl = document.getElementById("contact-popup");
        const btnEl = document.getElementById("contact-btn");
        const popupClose = document.querySelector("#contact-popup .close");
        if (popupEl && btnEl && popupClose) {
          btnEl.onclick = () => popupEl.style.display = "flex";
          popupClose.onclick = () => popupEl.style.display = "none";
          window.addEventListener("click", e => { if (e.target === popupEl) popupEl.style.display = "none"; });
        }

        requestAnimationFrame(() => {
          document.querySelectorAll(".nav-links a").forEach(a => a.style.visibility = "visible");

          let currentPage = window.location.pathname.split("/").pop().toLowerCase() || "index.html";
          document.querySelectorAll("nav a").forEach(link => {
            const href = (link.getAttribute("href") || "").split("?")[0].split("/").pop().toLowerCase() || "index.html";
            link.classList.toggle("active", href === currentPage);
            link.style.visibility = "visible";
          });

          decorateLinks(mode);
        });
      }

      function setMode(mode){
        document.body.classList.remove("mode-hub", "mode-standard");

        if (mode === "hub") {
          document.body.classList.add("mode-hub");
          hub.style.display = "block";
          standard.style.display = "none";
          decorateLinks("hub");
        } else {
          document.body.classList.add("mode-standard");
          hub.style.display = "none";
          standard.style.display = "block";
          decorateLinks("standard");
        }

        window.scrollTo(0,0);
      }

      // ===== Fireworks (gate only) =====
      (function initFireworks(){
        const canvas = document.getElementById("nl-fireworks");
        if (!canvas) return;
        const ctx = canvas.getContext("2d");
        let w = 0, h = 0, dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));

        const colors = ["#ff4d4d","#ffd24d","#4dff88","#4dd2ff","#b84dff","#ff4dd2"];
        const bursts = [];
        const particles = [];

        function resize(){
          w = canvas.clientWidth;
          h = canvas.clientHeight;
          canvas.width = Math.floor(w * dpr);
          canvas.height = Math.floor(h * dpr);
          ctx.setTransform(dpr,0,0,dpr,0,0);
        }
        resize();
        window.addEventListener("resize", resize);

        function rand(min,max){ return Math.random()*(max-min)+min; }

        function spawnBurst(){
          bursts.push({
            x: rand(w*0.15, w*0.85),
            y: rand(h*0.12, h*0.55),
            color: colors[(Math.random()*colors.length)|0],
            life: 0
          });
        }

        function explode(b){
          const count = (Math.random() < 0.35) ? 120 : 80;
          for(let i=0;i<count;i++){
            const a = (Math.PI*2) * (i/count) + rand(-0.08,0.08);
            const sp = rand(1.4, 4.6);
            particles.push({
              x: b.x, y: b.y,
              vx: Math.cos(a)*sp,
              vy: Math.sin(a)*sp,
              g: rand(0.012,0.03),
              drag: rand(0.985,0.992),
              alpha: 1,
              fade: rand(0.008,0.02),
              r: rand(1.1,2.2),
              color: b.color
            });
          }
        }

        let t = 0;
        function tick(){
          t++;

          // spawn bursts for the first ~8 seconds at 60fps (≈480 frames)
          if (t < 480 && t % 18 === 0) spawnBurst();

          ctx.clearRect(0,0,w,h);

          // bursts pop quickly into particles
          for(let i=bursts.length-1;i>=0;i--){
            const b = bursts[i];
            b.life++;
            if(b.life === 1) explode(b);
            if(b.life > 2) bursts.splice(i,1);
          }

          // draw particles
          for(let i=particles.length-1;i>=0;i--){
            const p = particles[i];
            p.vx *= p.drag;
            p.vy *= p.drag;
            p.vy += p.g;
            p.x += p.vx;
            p.y += p.vy;
            p.alpha -= p.fade;

            if(p.alpha <= 0 || p.x < -50 || p.x > w+50 || p.y > h+80){
              particles.splice(i,1);
              continue;
            }

            ctx.globalAlpha = Math.max(0, p.alpha);
            ctx.fillStyle = p.color;
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
            ctx.fill();
          }

          ctx.globalAlpha = 1;

          // continue anim while gate exists
          if (document.getElementById("nl-gate")) {
            requestAnimationFrame(tick);
          }
        }

        requestAnimationFrame(tick);

        // Fade fireworks layer out after 8 seconds (still gate stays)
        setTimeout(() => {
          canvas.classList.add("fade-out");
        }, 8000);
      })();

      // ===== GATE RULE =====
      const isInternalNav = (nav === "1");

      if (isInternalNav) {
        if (gate) gate.remove();

        const initialMode = (modeParam === "hub" || modeParam === "standard") ? modeParam : "standard";
        setMode(initialMode);

        if (initialMode === "standard") {
          loadGlobalForStandard("standard");
        }
      } else {
        hub.style.display = "none";
        standard.style.display = "none";
      }

      // ===== BUTTONS =====
      enterBtn.addEventListener("click", () => {
        history.replaceState({}, "", "index.html" + buildModeQuery("hub"));
        setMode("hub");
        closeGate();
      });

      skipBtn.addEventListener("click", async () => {
        history.replaceState({}, "", "index.html" + buildModeQuery("standard"));
        setMode("standard");
        await loadGlobalForStandard("standard");
        closeGate();
      });

    })();
  </script>

</body>
</html>
