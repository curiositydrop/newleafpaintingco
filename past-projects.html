<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>New Leaf Painting Projects | Luxury & General Homes in Maine</title>
  <meta name="description" content="See past interior painting projects by New Leaf Painting Co., serving Cumberland, Falmouth, Cape Elizabeth, Yarmouth, Kennebunkport, and all of Southern Maine. High-quality painting on walls, trim, baseboards, cabinets, and doors for every home.">
  <link rel="stylesheet" href="style.css" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZFESYBBBWD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZFESYBBBWD');
  </script>

  <style>
    /* ===== Existing gallery styles (kept) ===== */
    .project-gallery {
      display: flex;
      gap: 20px;
      justify-content: center;
      align-items: flex-start;
      flex-wrap: nowrap;
      max-width: 900px;
      margin: 0 auto;
    }
    .image-wrap {
      text-align: center;
      flex: 1;
      max-width: 400px;
    }
    .project-gallery img {
      width: 85%;
      height: auto;
      border-radius: 6px;
    }
    .project-divider {
      border: none;
      height: 6px;
      width: 85%;
      margin: 10px auto 50px auto;
      background-color: #1f6b33;
      border-radius: 6px;
    }

    /* ===== Before/After Slider ===== */
    .ba {
      max-width: 900px;
      margin: 0 auto 10px auto;
      padding: 0 10px;
    }
    .ba-slider {
      position: relative;
      width: 100%;
      max-width: 820px;
      margin: 12px auto 0 auto;
      border-radius: 10px;
      overflow: hidden;
      background: #0e0f10;
      box-shadow: 0 10px 24px rgba(0,0,0,.15);
      user-select: none;
      touch-action: pan-y;
    }
    .ba-slider img.ba-base {
      display: block;
      width: 100%;
      height: auto;
      max-height: 520px;
      object-fit: cover;
    }
    .ba-before {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 50%;
      overflow: hidden;
    }
    .ba-before img {
      height: 100%;
      width: 100%;
      object-fit: cover;
    }

    .ba-handle {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      height: 100%;
      width: 44px;
      cursor: ew-resize;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
    }
    .ba-handle::before {
      content: "";
      position: absolute;
      height: 100%;
      width: 4px;
      background: rgba(255,255,255,.9);
      border-radius: 4px;
    }
    .ba-knob {
      position: relative;
      width: 38px;
      height: 38px;
      border-radius: 999px;
      background: rgba(31,107,51,.95);
      border: 2px solid rgba(255,255,255,.9);
      display: grid;
      place-items: center;
      box-shadow: 0 6px 16px rgba(0,0,0,.25);
    }
    .ba-knob span {
      display: inline-block;
      font-size: 18px;
      color: #fff;
      line-height: 1;
      transform: translateY(-1px);
    }

    .ba-label {
      position: absolute;
      top: 12px;
      padding: 8px 10px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 12px;
      letter-spacing: .3px;
      background: rgba(0,0,0,.55);
      color: #fff;
      backdrop-filter: blur(6px);
    }
    .ba-label.before { left: 12px; }
    .ba-label.after  { right: 12px; }

    .ba-hint {
      text-align: center;
      font-size: 13px;
      opacity: .85;
      margin-top: 8px;
    }

    @media (max-width: 640px) {
      .ba-slider img.ba-base { max-height: 420px; }
    }

    /* ===== MODE SUPPORT (new) ===== */
    body.mode-hub #global-header,
    body.mode-hub #global-footer,
    body.mode-hub #contact-btn,
    body.mode-hub #contact-popup { display: none !important; }

    /* If they came from the Experience, make nav look like CTA buttons */
    body.mode-hub .nav-links a{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 12px;
      border-radius: 12px;
      border: 2px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      color: #fff !important;
      font-weight: 800;
      text-decoration: none;
      transition: transform .12s ease, filter .12s ease;
    }
    body.mode-hub .nav-links a:hover{ transform: translateY(-1px); filter: brightness(1.05); }
    body.mode-hub header{ background:#0f5f33; }
  </style>
</head>

<body>

  <!-- GLOBAL HEADER -->
  <div id="global-header"></div>

  <!-- PAGE CONTENT -->
  <section class="hero">
    <h1>Our Completed Transformations</h1>
    <p>Take a look at some of the spaces, surfaces, and projects we’ve transformed — and the clients we’ve delighted.</p>
  </section>

  <!-- ===== Project 1: Slider ===== -->
  <div style="text-align: center;">
    <h3>Kitchen Cabinet Refresh</h3>
    <p>This cabinet respray gave this kitchen a nice new look.</p>
  </div>

  <div class="ba">
    <div class="ba-slider" aria-label="Before and after slider">
      <img class="ba-base" src="IMG_8455.jpeg" alt="Cabinet repaint after" loading="lazy">
      <div class="ba-before">
        <img src="IMG_8428.jpeg" alt="Cabinet repaint before" loading="lazy">
      </div>

      <div class="ba-label before">BEFORE</div>
      <div class="ba-label after">AFTER</div>

      <div class="ba-handle">
        <div class="ba-knob" aria-hidden="true"><span>⇆</span></div>
      </div>
    </div>
    <div class="ba-hint">Drag the green slider to reveal the transformation.</div>
  </div>

  <hr class="project-divider">

  <!-- ===== Project 2: Slider + extra angles (clickable) ===== -->
  <div style="text-align: center;">
    <h3>Kitchen Cabinet Painting</h3>
    <p>This cabinet respray gave this kitchen a whole new look.</p>
  </div>

  <div class="ba">
    <div class="ba-slider" aria-label="Before and after slider">
      <img class="ba-base" src="IMG_8599.jpeg" alt="Cabinet repaint after" loading="lazy">
      <div class="ba-before">
        <img src="IMG_7625.jpeg" alt="Cabinet repaint before" loading="lazy">
      </div>

      <div class="ba-label before">BEFORE</div>
      <div class="ba-label after">AFTER</div>

      <div class="ba-handle">
        <div class="ba-knob" aria-hidden="true"><span>⇆</span></div>
      </div>
    </div>
    <div class="ba-hint">Drag the green slider to reveal the transformation.</div>
  </div>

  <div class="project-gallery">
    <div class="image-wrap">
      <img src="IMG_7628.jpeg" alt="Cabinet repaint before angle" class="clickable-img">
      <p class="caption before">Before (Angle)</p>
    </div>

    <div class="image-wrap">
      <img src="IMG_8601.jpeg" alt="Cabinet repaint after angle" class="clickable-img">
      <p class="caption after">After (Angle)</p>
    </div>
  </div>

  <hr class="project-divider">

  <section class="projects">
    <div class="project-card">
      <img src="IMG_8114.jpeg" alt="Kitchen paint" class="clickable-img">
      <img src="IMG_8117.jpeg" alt="Kitchen paint" class="clickable-img">
      <img src="IMG_8125.jpeg" alt="Kitchen paint" class="clickable-img">
      <h3>Kitchen Refresh</h3>
      <p>Tile backsplash and new coat of paint gave this kitchen a nice new look.</p>
    </div>
  </section>

  <section class="projects">
    <div class="project-card">
      <img src="IMG_8118.jpeg" alt="Master Bedroom paint" class="clickable-img">
      <img src="IMG_8119.jpeg" alt="Master Bedroom paint" class="clickable-img">
      <img src="IMG_8120.jpeg" alt="Master Bedroom paint" class="clickable-img">
      <h3>Bedroom Makeover</h3>
      <p>Freshly painted walls and contrasting trim create a serene and elegant master bedroom space.</p>
    </div>
  </section>

  <!-- IMAGE MODAL -->
  <div id="imgModal" class="img-modal">
    <span class="close">&times;</span>
    <img class="modal-content" id="modalImage">
  </div>

  <script>
    // ===== Before/After slider logic =====
    function initBASliders() {
      document.querySelectorAll(".ba-slider").forEach(slider => {
        const beforeWrap = slider.querySelector(".ba-before");
        const handle = slider.querySelector(".ba-handle");

        let dragging = false;

        const setPos = (clientX) => {
          const rect = slider.getBoundingClientRect();
          const x = Math.min(Math.max(clientX - rect.left, 0), rect.width);
          const pct = (x / rect.width) * 100;

          beforeWrap.style.width = pct + "%";
          handle.style.left = pct + "%";
        };

        slider.addEventListener("mousedown", (e) => {
          dragging = true;
          setPos(e.clientX);
        });
        window.addEventListener("mousemove", (e) => {
          if (!dragging) return;
          setPos(e.clientX);
        });
        window.addEventListener("mouseup", () => dragging = false);

        slider.addEventListener("touchstart", (e) => {
          dragging = true;
          setPos(e.touches[0].clientX);
        }, { passive: true });
        slider.addEventListener("touchmove", (e) => {
          if (!dragging) return;
          setPos(e.touches[0].clientX);
        }, { passive: true });
        slider.addEventListener("touchend", () => dragging = false);

        requestAnimationFrame(() => {
          const rect = slider.getBoundingClientRect();
          setPos(rect.left + rect.width / 2);
        });
      });
    }

    // ===== Image Modal logic =====
    function initImageModal() {
      const modal = document.getElementById("imgModal");
      const modalImg = document.getElementById("modalImage");
      const closeBtn = modal.querySelector(".close");

      document.querySelectorAll(".clickable-img").forEach(img => {
        img.onclick = () => {
          modal.style.display = "flex";
          modalImg.src = img.src;
        };
      });

      closeBtn.onclick = () => modal.style.display = "none";
      window.onclick = e => { if (e.target === modal) modal.style.display = "none"; };
    }

    document.addEventListener("DOMContentLoaded", () => {
      initBASliders();
      initImageModal();
    });
  </script>

  <!-- GLOBAL FOOTER -->
  <div id="global-footer"></div>

  <!-- ===== GLOBAL INJECT + MODE (new) ===== -->
  <script>
    (function(){
      const params = new URLSearchParams(window.location.search);
      const nav = params.get("nav"); // should be "1" for internal navigation
      const mode = (params.get("mode") || "standard").toLowerCase(); // hub | standard

      // Apply body mode class for styling/hide rules
      document.body.classList.remove("mode-hub","mode-standard");
      document.body.classList.add(mode === "hub" ? "mode-hub" : "mode-standard");

      function buildQS(m){ return `?nav=1&mode=${encodeURIComponent(m)}`; }

      function isExternalHref(href){
        return href.startsWith("http://") || href.startsWith("https://") || href.startsWith("mailto:") || href.startsWith("tel:");
      }

      // Decorate internal links to preserve mode + nav
      function decorateLinks(m){
        document.querySelectorAll('a[href]').forEach(a => {
          const href = a.getAttribute("href");
          if (!href) return;
          if (href.startsWith("#")) return;
          if (href.startsWith("javascript:")) return;
          if (isExternalHref(href)) return;
          if (href.includes("nav=1")) return;

          const joiner = href.includes("?") ? "&" : "?";
          a.setAttribute("href", href + joiner + `nav=1&mode=${encodeURIComponent(m)}`);
        });
      }

      async function injectGlobal(){
        const res = await fetch("global.html");
        const html = await res.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, "text/html");

        const header = doc.querySelector("header");
        const footer = doc.querySelector("footer");
        const popup  = doc.querySelector("#contact-popup");
        const btn    = doc.querySelector("#contact-btn");

        const headerTarget = document.getElementById("global-header");
        const footerTarget = document.getElementById("global-footer");

        if (headerTarget && header) headerTarget.replaceChildren(header);
        if (footerTarget && footer) footerTarget.replaceChildren(footer);

        if (popup && !document.querySelector("#contact-popup")) document.body.insertAdjacentElement("beforeend", popup);
        if (btn && !document.querySelector("#contact-btn")) document.body.insertAdjacentElement("beforeend", btn);

        // Force HOME to return to the chosen “home” (hub or boring), NOT the gate
        const homeLink = document.getElementById("homeLink");
        if (homeLink){
          homeLink.href = "index.html" + buildQS(mode === "hub" ? "hub" : "standard");
        }

        // Setup popup close/open
        const popupEl = document.getElementById("contact-popup");
        const btnEl = document.getElementById("contact-btn");
        const popupClose = document.querySelector("#contact-popup .close");
        if (popupEl && btnEl && popupClose) {
          btnEl.onclick = () => popupEl.style.display = "flex";
          popupClose.onclick = () => popupEl.style.display = "none";
          window.addEventListener("click", e => { if (e.target === popupEl) popupEl.style.display = "none"; });
        }

        // Preserve mode across all links
        decorateLinks(mode === "hub" ? "hub" : "standard");

        // Optional: hide “fun row” if it exists
        const funRow = document.getElementById("nl-experience-nav");
        if (funRow && mode !== "hub") funRow.style.display = "none";
      }

      // We do NOT force-gate on inner pages. Gate rule remains: typing the DOMAIN/root shows it.
      // But: if someone landed here without nav=1, we still preserve styling with default mode=standard.
      injectGlobal();
    })();
  </script>

</body>
</html>
