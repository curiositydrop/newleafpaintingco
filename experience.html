<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Experience | New Leaf Painting Co.</title>
  <meta name="description" content="A fun, interactive portal into the New Leaf Painting experience. Unlock one-time deals and claim discounts." />

  <style>
    :root{
      --bg:#000;
      --panel: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);

      /* Your green */
      --green:#1f6b33;

      /* Glow accent */
      --glow: rgba(80,255,160,.28);
      --accent: rgba(80,255,160,.55);
    }

    *{ box-sizing: border-box; }
    html,body{ margin:0; padding:0; background:var(--bg); color:var(--text); overflow-x:hidden; }
    a{ color: inherit; text-decoration:none; }

    /* ===== Ambient portal background ===== */
    .portal-bg{
      position: fixed;
      inset: 0;
      z-index: -2;
      background:
        radial-gradient(900px 420px at 50% 0%, rgba(80,255,160,.14), transparent 60%),
        radial-gradient(700px 420px at 15% 30%, rgba(31,107,51,.16), transparent 65%),
        radial-gradient(700px 420px at 85% 35%, rgba(80,255,160,.10), transparent 60%),
        #000;
      filter: saturate(1.08);
    }
    .grain{
      position: fixed;
      inset:0;
      z-index:-1;
      pointer-events:none;
      opacity:.09;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
    }

    /* ===== Layout ===== */
    .wrap{
      max-width: 1040px;
      margin: 0 auto;
      padding: 18px 14px 70px;
    }

    /* ===== Top bar (minimal portal nav) ===== */
    .topbar{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 12px;
      padding: 10px 0 16px;
      flex-wrap: wrap;
    }

    .leaf-brand{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }

    .leaf-logo{
      width: 54px;
      height: 54px;
      border-radius: 14px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 0 22px rgba(80,255,160,.18);
      display:grid;
      place-items:center;
      overflow:hidden;
    }
    .leaf-logo img{
      width: 92%;
      height: 92%;
      object-fit: contain;
      display:block;
      filter: drop-shadow(0 0 12px rgba(80,255,160,.25));
    }

    .leaf-title{
      display:flex;
      flex-direction:column;
      line-height:1.15;
      min-width:0;
    }
    .leaf-title strong{
      font-size: 14px;
      letter-spacing: .2px;
      color: rgba(255,255,255,.92);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .leaf-title span{
      font-size: 12px;
      color: var(--muted);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }

    .top-actions{
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap: wrap;
      justify-content:flex-end;
    }

    /* ===== Buttons (match your vibe) ===== */
    .nl-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.92);
      font-weight: 900;
      letter-spacing: .2px;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease, background .12s ease;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    .nl-btn:hover{ transform: translateY(-1px); filter: brightness(1.06); background: rgba(255,255,255,.09); }

    .nl-btn.primary{
      border-color: rgba(80,255,160,.28);
      background: linear-gradient(180deg, rgba(31,107,51,.40), rgba(31,107,51,.18));
      box-shadow: 0 0 22px rgba(80,255,160,.16);
    }

    .nl-btn.ghost{
      background: transparent;
      border-color: rgba(255,255,255,.18);
    }

    .nl-btn:disabled{
      opacity:.45;
      cursor:not-allowed;
      transform:none !important;
      filter:none !important;
    }

    /* ===== Portal hero ===== */
    .hero{
      margin-top: 6px;
      padding: 18px 16px 14px;
      border-radius: 18px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow:
        0 18px 50px rgba(0,0,0,.55),
        0 0 34px rgba(80,255,160,.12);
      overflow:hidden;
      position:relative;
    }

    .hero::before{
      content:"";
      position:absolute;
      inset:-60px -40px auto -40px;
      height: 220px;
      background: radial-gradient(closest-side, rgba(80,255,160,.20), transparent 70%);
      filter: blur(10px);
      opacity:.85;
    }

    .hero h1{
      margin: 0 0 8px;
      font-size: clamp(1.5rem, 3.2vw, 2.2rem);
      letter-spacing: .3px;
      color: rgba(80,255,160,.95);
      text-shadow: 0 0 14px rgba(80,255,160,.18);
      position:relative;
    }
    .hero p{
      margin: 0;
      max-width: 820px;
      color: rgba(255,255,255,.82);
      line-height: 1.5;
      position:relative;
    }

    .type-line{
      margin-top: 10px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      color: rgba(255,255,255,.80);
      font-size: 13px;
      background: rgba(0,0,0,.38);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 12px;
      padding: 10px 12px;
      position:relative;
    }
    .cursor{
      display:inline-block;
      width: 10px;
      height: 16px;
      transform: translateY(2px);
      background: rgba(80,255,160,.9);
      margin-left: 3px;
      animation: blink .9s steps(1) infinite;
      border-radius: 2px;
    }
    @keyframes blink{ 50%{ opacity:0; } }

    /* ===== Card ===== */
    .card{
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 18px;
      padding: 16px;
      box-shadow: 0 12px 28px rgba(0,0,0,.45);
      margin-top: 14px;
    }
    .card h2{
      margin: 0 0 10px;
      color: rgba(80,255,160,.92);
      letter-spacing: .2px;
      font-size: 1.15rem;
    }
    .card p{
      margin: 0 0 10px;
      color: rgba(255,255,255,.78);
      line-height: 1.5;
    }

    /* ===== Deal Portal ===== */
    .deal-choices{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }

    .deal-choice{
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      cursor:pointer;
      font-weight: 900;
      color: rgba(255,255,255,.88);
      transition: transform .12s ease, filter .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    .deal-choice:hover{ transform: translateY(-1px); filter: brightness(1.06); }
    .deal-choice.active{
      border-color: rgba(80,255,160,.55);
      box-shadow: 0 0 18px rgba(80,255,160,.16);
      color: rgba(80,255,160,.98);
    }

    .deal-note{
      font-size: 13px;
      color: rgba(255,255,255,.68);
    }

    .leaf-picks{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    @media (max-width: 720px){
      .leaf-picks{ grid-template-columns: 1fr; }
    }

    .leaf-pick{
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      padding: 12px;
      cursor:pointer;
      display:flex;
      flex-direction:column;
      gap: 10px;
      align-items:center;
      transition: transform .12s ease, filter .12s ease, border-color .12s ease;
      user-select:none;
    }
    .leaf-pick:hover{
      transform: translateY(-2px);
      filter: brightness(1.06);
      border-color: rgba(80,255,160,.35);
    }
    .leaf-pick img{
      width: 90px;
      height: 90px;
      object-fit: contain;
      filter: drop-shadow(0 0 14px rgba(80,255,160,.22));
    }
    .leaf-pick span{
      font-weight: 900;
      color: rgba(255,255,255,.92);
    }

    .deal-box{
      max-width: 860px;
      padding: 16px;
      border-radius: 16px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 0 24px rgba(80,255,160,.10);
    }
    .deal-title{
      font-weight: 950;
      font-size: 1.2rem;
      color: rgba(80,255,160,.98);
      margin-bottom: 8px;
    }
    .deal-details{
      color: rgba(255,255,255,.85);
      line-height: 1.5;
      white-space: pre-line;
    }

    /* ===== Popup form ===== */
    .popup{
      display:none;
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: rgba(0,0,0,.72);
      justify-content:center;
      align-items:center;
      padding: 18px 12px;
    }
    .popup-content{
      width: 100%;
      max-width: 440px;
      border-radius: 16px;
      background: rgba(10,10,10,.96);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow:
        0 26px 70px rgba(0,0,0,.70),
        0 0 30px rgba(80,255,160,.12);
      padding: 18px 16px 16px;
      position: relative;
      color: var(--text);
    }
    .popup-content h2{
      margin: 4px 0 12px;
      text-align:center;
      font-size: 1.15rem;
      color: rgba(80,255,160,.95);
    }
    .popup-content .close{
      position:absolute;
      top: 8px;
      right: 10px;
      border:none;
      background: transparent;
      color:#fff;
      font-size: 34px;
      font-weight: 900;
      cursor:pointer;
      line-height:1;
    }
    .field{ margin: 10px 0; }
    label{
      display:block;
      margin: 0 0 6px;
      font-weight: 900;
      color: rgba(255,255,255,.82);
      font-size: .92rem;
    }
    input, textarea{
      width: 100%;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: #fff;
      padding: 10px 12px;
      outline: none;
    }
    textarea{ resize: vertical; }
    #estimate-send{
      width:100%;
      margin-top: 12px;
      border-radius: 12px;
      border: 2px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.92);
      color: #0f5f33;
      padding: 12px 14px;
      font-weight: 900;
      cursor: pointer;
    }
    #estimate-send:hover{ filter: brightness(1.03); }

    /* ===== Footer-ish ===== */
    .portal-footer{
      margin-top: 18px;
      text-align:center;
      color: rgba(255,255,255,.65);
      font-size: 12px;
      padding-top: 14px;
    }
  </style>
</head>

<body>
  <div class="portal-bg"></div>
  <div class="grain"></div>

  <div class="wrap">

    <!-- Minimal portal top bar -->
    <div class="topbar">
      <div class="leaf-brand">
        <div class="leaf-logo">
          <!-- Replace with your leaf mascot file -->
          <img src="LEAF_MASCOT.png" alt="New Leaf Mascot">
        </div>
        <div class="leaf-title">
          <strong>New Leaf Painting Co.</strong>
          <span>The Experience Portal</span>
        </div>
      </div>

      <div class="top-actions">
        <a class="nl-btn ghost" href="index.html">Home</a>
        <a class="nl-btn" href="past-projects.html">Past Projects</a>
        <a class="nl-btn primary" href="#" data-contact-open="1">Get Free Estimate</a>
      </div>
    </div>

    <!-- Portal hero -->
    <section class="hero">
      <h1>Welcome to The Experience</h1>
      <p>
        This isn’t a boring painting website. It’s a preview of what it feels like when your home gets a <i>new leaf</i> —
        cleaner lines, brighter rooms, and work done the right way.
      </p>

      <div class="type-line" aria-label="Portal message">
        <span id="typeText"></span><span class="cursor"></span>
      </div>
    </section>

    <!-- ===== WOW DEAL PORTAL ===== -->
    <section class="card">
      <h2>Unlock a Deal</h2>
      <p>Select what you’re thinking about painting. Then choose your Leaf. One pick. One deal.</p>

      <!-- Step 1 -->
      <div id="dealStep1">
        <div class="deal-choices" id="serviceChoices">
          <button class="deal-choice" type="button" data-key="walls">Walls / Ceilings</button>
          <button class="deal-choice" type="button" data-key="trim">Trim / Doors</button>
          <button class="deal-choice" type="button" data-key="cabinets">Kitchen Cabinets</button>
          <button class="deal-choice" type="button" data-key="other">Not sure yet</button>
        </div>

        <button class="nl-btn primary" id="toLeafStep" type="button" disabled style="margin-top:12px;">
          Next → Choose Your Leaf
        </button>

        <p class="deal-note" style="margin-top:10px;">
          (Pick all that apply — your deal will match your choices.)
        </p>
      </div>

      <!-- Step 2 -->
      <div id="dealStep2" style="display:none; margin-top:16px;">
        <h2 style="margin:0 0 8px; color: rgba(80,255,160,.92);">Choose your Leaf.</h2>
        <p style="margin:0 0 12px; color: rgba(255,255,255,.78);">This is your one-time pick.</p>

        <div class="leaf-picks">
          <!-- TEMP: you can use the same image 3x for now if you want -->
          <button class="leaf-pick" type="button" data-leaf="alpha">
            <img src="LEAF_ALPHA.png" alt="Leaf Alpha">
            <span>Leaf Alpha</span>
          </button>

          <button class="leaf-pick" type="button" data-leaf="rebel">
            <img src="LEAF_REBEL.png" alt="Leaf Rebel">
            <span>Leaf Rebel</span>
          </button>

          <button class="leaf-pick" type="button" data-leaf="lucky">
            <img src="LEAF_LUCKY.png" alt="Leaf Lucky">
            <span>Leaf Lucky</span>
          </button>
        </div>

        <p class="deal-note" style="margin-top:10px;">
          Tip: for now you can point all 3 images at <b>LEAF_MASCOT.png</b> if you don’t have variants yet.
        </p>
      </div>

      <!-- Step 3 -->
      <div id="dealStep3" style="display:none; margin-top:16px;">
        <h2 style="margin:0 0 10px; color: rgba(80,255,160,.95);">Unlocked Deal</h2>

        <div class="deal-box">
          <div id="dealTitle" class="deal-title"></div>
          <div id="dealDetails" class="deal-details"></div>
        </div>

        <button class="nl-btn primary" id="claimDeal" type="button" style="margin-top:12px;">
          Claim this deal
        </button>

        <button class="nl-btn ghost" id="resetDeal" type="button" style="margin-top:10px;">
          Reset (for testing only)
        </button>

        <p class="deal-note" style="margin-top:10px;">
          Deal locks to this browser (so people can’t spam it).
        </p>
      </div>
    </section>

    <div class="portal-footer">
      Powered by New Leaf Painting Co. • Southern Maine • “Different on purpose.”
    </div>

  </div>

  <!-- Estimate Popup (standalone for this page) -->
  <div id="contact-popup" class="popup" aria-modal="true" role="dialog" aria-label="Get free estimate popup">
    <div class="popup-content">
      <button type="button" class="close" aria-label="Close">&times;</button>
      <h2>Get free estimate</h2>

      <form id="estimate-form" novalidate>
        <div class="field">
          <label for="name">Name</label>
          <input type="text" id="name" name="name" placeholder="Your name">
        </div>

        <div class="field">
          <label for="email">Email</label>
          <input type="email" id="email" name="email" placeholder="you@email.com">
        </div>

        <div class="field">
          <label for="phone">Phone</label>
          <input type="tel" id="phone" name="phone" placeholder="(207) 555-1234">
        </div>

        <div class="field">
          <label for="message">Message</label>
          <textarea id="message" name="message" rows="4" placeholder="Tell me what you’re looking to paint…"></textarea>
        </div>

        <button id="estimate-send" type="button">Send</button>
      </form>
    </div>
  </div>

  <script>
    // ===== 1) Portal typing line (SLOWER + readable pause) =====
    (function(){
      const lines = [
        "Portal scan complete… ✅",
        "You have entered: The New Leaf Experience.",
        "Unlock a one-time deal. Choose wisely.",
        "If you ever need painting — you’ll remember this."
      ];

      const el = document.getElementById("typeText");
      let i=0, j=0, current="", deleting=false;

      const TYPE_SPEED = 55;     // slower typing
      const DELETE_SPEED = 18;   // deleting faster
      const END_PAUSE = 1400;    // pause after a full line

      function tick(){
        const target = lines[i];

        if (!deleting){
          current = target.slice(0, j++);
          el.textContent = current;

          if (j > target.length){
            setTimeout(() => { deleting = true; tick(); }, END_PAUSE);
            return;
          }
        } else {
          current = target.slice(0, j--);
          el.textContent = current;

          if (j <= 0){
            deleting=false;
            i = (i+1) % lines.length;
            j = 0;
          }
        }

        setTimeout(tick, deleting ? DELETE_SPEED : TYPE_SPEED);
      }

      tick();
    })();

    // ===== 2) WOW Deal Portal Logic =====
    (function(){
      const step1 = document.getElementById("dealStep1");
      const step2 = document.getElementById("dealStep2");
      const step3 = document.getElementById("dealStep3");

      const selected = new Set();
      let selectedDeal = null;

      // Deal pools (edit these anytime)
      const DEALS = {
        walls: [
          { title: "2+ Rooms Bonus", details: "Book 2+ rooms and get one small bedroom ceiling painted at ceiling-only pricing." },
          { title: "$150 Off 2-Room Package", details: "Take $150 off when painting 2+ rooms (walls/ceilings)." },
          { title: "Prep Upgrade Bonus", details: "Mention “EXPERIENCE” and I’ll include an upgraded prep plan in your quote." }
        ],
        trim: [
          { title: "Trim Add-On Special", details: "Bundle trim/doors with a room and get discounted add-on pricing." },
          { title: "Door Refresh Deal", details: "Reduced rate on interior door refresh when bundled with a room paint." }
        ],
        cabinets: [
          { title: "$500 Off Full Cabinet Refresh", details: "Unlock $500 off a full cabinet repaint package." },
          { title: "Cabinet Finish Bonus", details: "If we’re a fit, I’ll include a finish/flow plan so they lay down smooth." }
        ],
        other: [
          { title: "New Leaf Starter Deal", details: "Not sure yet? Mention “EXPERIENCE” and I’ll help you build the best plan for your home." }
        ]
      };

      // If already locked, show saved deal
      const locked = localStorage.getItem("xpDealLocked");
      if (locked) {
        selectedDeal = JSON.parse(locked);
        step1.style.display = "none";
        step2.style.display = "none";
        step3.style.display = "";
        document.getElementById("dealTitle").textContent = selectedDeal.title;
        document.getElementById("dealDetails").textContent = selectedDeal.details;
        return;
      }

      // Multi-select service buttons
      document.getElementById("serviceChoices").addEventListener("click", (e) => {
        const btn = e.target.closest(".deal-choice");
        if (!btn) return;

        const key = btn.dataset.key;
        if (selected.has(key)) {
          selected.delete(key);
          btn.classList.remove("active");
        } else {
          selected.add(key);
          btn.classList.add("active");
        }

        document.getElementById("toLeafStep").disabled = selected.size === 0;
      });

      // Step 1 -> Step 2
      document.getElementById("toLeafStep").addEventListener("click", () => {
        step1.style.display = "none";
        step2.style.display = "";
      });

      // Leaf pick -> reveal deal
      document.querySelectorAll(".leaf-pick").forEach(btn => {
        btn.addEventListener("click", () => {
          let pool = [];
          selected.forEach(k => { if (DEALS[k]) pool = pool.concat(DEALS[k]); });
          if (!pool.length) pool = DEALS.other;

          selectedDeal = pool[Math.floor(Math.random() * pool.length)];

          // Lock it (one-time)
          localStorage.setItem("xpDealLocked", JSON.stringify(selectedDeal));

          // Show Step 3
          step2.style.display = "none";
          step3.style.display = "";
          document.getElementById("dealTitle").textContent = selectedDeal.title;
          document.getElementById("dealDetails").textContent = selectedDeal.details;
        });
      });

      // Claim deal -> open estimate popup + auto-append deal to message
      document.getElementById("claimDeal").addEventListener("click", () => {
        const popup = document.getElementById("contact-popup");
        if (popup) popup.style.display = "flex";

        const msg = document.getElementById("message");
        if (msg && selectedDeal) {
          const stamp =
            `\n\n---\nUnlocked Deal: ${selectedDeal.title}\n${selectedDeal.details}\n---\n`;
          if (!msg.value.includes("Unlocked Deal:")) msg.value += stamp;
        }
      });

      // Reset (testing only)
      document.getElementById("resetDeal").addEventListener("click", () => {
        localStorage.removeItem("xpDealLocked");
        location.reload();
      });
    })();

    // ===== 3) Popup wiring (portal page only) =====
    const popup = document.getElementById("contact-popup");
    const openers = document.querySelectorAll('[data-contact-open="1"]');
    const closeBtn = popup.querySelector(".close");

    const openPopup = (e) => { if(e) e.preventDefault(); popup.style.display="flex"; };
    const closePopup = () => popup.style.display="none";

    openers.forEach(o => o.addEventListener("click", openPopup));
    closeBtn.addEventListener("click", closePopup);

    window.addEventListener("click", (e)=>{ if(e.target === popup) closePopup(); });
    window.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closePopup(); });

    // ===== 4) Send button wiring (mailto with their info) =====
    const sendBtn = document.getElementById("estimate-send");
    sendBtn.addEventListener("click", ()=>{
      const name = (document.getElementById("name").value || "").trim();
      const email = (document.getElementById("email").value || "").trim();
      const phone = (document.getElementById("phone").value || "").trim();
      const message = (document.getElementById("message").value || "").trim();

      if (!name || (!email && !phone)) {
        alert("Please enter your name and either an email or phone number.");
        return;
      }

      const to = "newleafpaintingcompany@gmail.com";
      const subject = encodeURIComponent(`Estimate Request - ${name}${phone ? " - " + phone : ""}`);

      const body = encodeURIComponent(
`Hi Mike,

I'd like a free estimate. Here’s my info:

Name: ${name}
Email: ${email || "(not provided)"}
Phone: ${phone || "(not provided)"}

Message:
${message || "(no message)"}

Thanks!`
      );

      window.location.href = `mailto:${to}?subject=${subject}&body=${body}`;
      closePopup();
    });
  </script>
</body>
</html>
